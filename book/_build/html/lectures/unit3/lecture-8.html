
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data access &#8212; Geospatial Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/unit3/lecture-8';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Initialize GitHub repository" href="../../final-project/initialize.html" />
    <link rel="prev" title="Assignment 8" href="../../labs/assignment7.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nsoe-logo.png" class="logo__image only-light" alt="Geospatial Data Science - Home"/>
    <img src="../../_static/nsoe-logo.png" class="logo__image only-dark pst-js-only" alt="Geospatial Data Science - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Geospatial Data Science!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../course-info/general-info.html">General information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/schedule.html">Schedule (for Fall 2025)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/github.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/format.html">Formatting answers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/final-project.html">Final projects</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/lecture-1.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/rivers.html">Rivers of the World Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment1.html">Assignment 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/lecture-2.html">Vector data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/flooding.html">Residential Flooding Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment2.html">Assignment 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/lecture-3.html">Network data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/census.html">Census Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment3.html">Assignment 3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/lecture-4a.html">Gridded data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/lecture-4b.html">Climate data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment4.html">Assignment 4</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-5.html">Machine learning fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/wines.html">Wine activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment5.html">Assignment 5</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../final-project/baby.html">Baby</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-6a.html">Machine learning applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-6b.html">Neural networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/penguins.html">Penguin activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment6.html">Assignment 6</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../final-project/fall-break.html">Fall break</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-project/project-ideas.html">Assignment 7</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-7.html">Specialized neural networks</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../activities/eurosat.html">EuroSAT activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment7.html">Assignment 8</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-project/initialize.html">Initialize GitHub repository</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 11</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-9.html">Code management</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 12</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-10.html">Automating raster analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 13</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit4/lecture-11a.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit4/lecture-11b.html">Maps with data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ryan-lab-duke/gds-applications-site" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ryan-lab-duke/gds-applications-site/issues/new?title=Issue%20on%20page%20%2Flectures/unit3/lecture-8.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lectures/unit3/lecture-8.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data access</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apis">APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-request">API request</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restful-web-apis">RESTful web APIs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#north-carolina-data">North Carolina data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#url-parameters">URL Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#census-bureau-data">Census Bureau data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-wrappers">API wrappers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrological-data-from-usgs">Hydrological data from USGS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-for-apis">Tips for APIs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-and-satellite-data">Climate and satellite data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-catalog">Search catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-least-cloudy-image">Find least cloudy image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-rendered-image">Show rendered image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-image">Import image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">Plot time-series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-limits">API limits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#web-scraping">Web scraping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suppose-a-friend-wanted-to-do-this">Suppose a friend wanted to do this?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selenium">Selenium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-access">
<h1>Data access<a class="headerlink" href="#data-access" title="Link to this heading">#</a></h1>
<p>So far in this course we have mainly been downloading data from OneDrive links provided by the instructor. But for our final projects, we will have to search for and download data independently. Finding, downloading, and cleaning data is an important, but laborious, part of geospatial data science. In this demo, we will learn how to <strong>download data programmatically</strong>. There are two good reasons for downloading data in this way:</p>
<ol class="arabic simple">
<li><p>It is <strong>automated</strong>, meaning that it is both faster and more accurate than pointing and clicking</p></li>
<li><p>It <strong>links</strong> the data access <strong>to</strong> our data analysis, meaning that we can make our analysis more <strong>reproducible</strong> (for ourselves <strong>and</strong> others!)</p></li>
</ol>
<p>We will mainly learn about downloading data using <strong>Application Programming Interfaces (APIs)</strong>. We will also talk about options for downloading data when an API is unavailable or insufficient.</p>
<section id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Link to this heading">#</a></h2>
<p>Most organizations responsible for collecting, organizing, and storing data have a <strong>public API</strong> that we can use to access their data. An API is a type of software that provides a <strong>standard set of protocols/functions</strong> so that our computer can <strong>communicate</strong> with other computers (in contrast, a <strong>user interface</strong> is a type of software that connects a <strong>computer</strong> to a <strong>person</strong>). A <strong>web API</strong> is an API that allows our computer to communicate with other computers <strong>over the internet</strong>, typically using HTTPS.</p>
<a class="reference internal image-reference" href="../../_images/api.svg"><img alt="../../_images/api.svg" class="align-center" src="../../_images/api.svg" style="width: 800px;" /></a>
<section id="api-request">
<h3>API request<a class="headerlink" href="#api-request" title="Link to this heading">#</a></h3>
<p>There are two key componets of an API: a <strong>request</strong> and a <strong>response</strong>.</p>
<ul class="simple">
<li><p>We first send a <strong>request</strong> to a data source (i.e. <strong>endpoint</strong>). The request typically looks like a URL that we would type into a web browser except it contains sets of parameters that specify the type and particular subset of data that we are interested in.</p></li>
<li><p>The endpoint will then return a <strong>response</strong> code plus the data we asked for. Perhaps the most familiar response is the <strong>“404 Not Found”</strong> which is an HTTP status code that indicates the server could not find the requested resource.</p></li>
</ul>
</section>
<section id="restful-web-apis">
<h3>RESTful web APIs<a class="headerlink" href="#restful-web-apis" title="Link to this heading">#</a></h3>
<p>There are many different types of web APIs but one the most common types is a <code class="docutils literal notranslate"><span class="pre">REST</span></code> or <code class="docutils literal notranslate"><span class="pre">RESTful</span></code>. A RESTful API is a web API that uses URL arguments to specify what information we want returned through the API.</p>
<p>To put this all into perspective, next, you will explore a RESTful API interface example. For these kind of tasks, we have to carefully inspect the API <strong>documentation</strong> to understand what functions are available and what keyword arguments they require.</p>
</section>
</section>
<section id="north-carolina-data">
<h2>North Carolina data<a class="headerlink" href="#north-carolina-data" title="Link to this heading">#</a></h2>
<p>North Carolina has a service called <strong>Log Into North Carolina (LINC)</strong> which is an interactive data retrieval service containing historical information for over 900 data items and a variety of geographic areas within the state. Topics include: population, labor force, education, transportation, revenue, agriculture, vital statistics, energy and utilities, for a variety of geographic areas within the state.</p>
<a class="reference internal image-reference" href="../../_images/linc.png"><img alt="../../_images/linc.png" class="align-center" src="../../_images/linc.png" style="width: 300px;" /></a>
<p>The <strong>LINC API</strong> is organized around REST can be accessed from the following link <code class="docutils literal notranslate"><span class="pre">https://linc.osbm.nc.gov/api/explore/v2.1/</span></code>. The homepage provides a list of <strong>requests</strong> that can be used for querying and accessing data.</p>
<a class="reference internal image-reference" href="../../_images/linc-catalog.png"><img alt="../../_images/linc-catalog.png" class="align-center" src="../../_images/linc-catalog.png" style="width: 700px;" /></a>
<a class="reference internal image-reference" href="../../_images/linc-dataset.png"><img alt="../../_images/linc-dataset.png" class="align-center" src="../../_images/linc-dataset.png" style="width: 700px;" /></a>
<p>The API has a request that allows us to export the dataset as a csv file. We can do this using the Python package called <code class="docutils literal notranslate"><span class="pre">requests</span></code>.</p>
<p>We will start by downloading the <strong>monthly labor force</strong> dataset.</p>
<a class="reference internal image-reference" href="../../_images/labor-force.png"><img alt="../../_images/labor-force.png" class="align-center" src="../../_images/labor-force.png" style="width: 700px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Define base URL</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://linc.osbm.nc.gov/api/explore/v2.1/catalog/datasets/&#39;</span>

<span class="c1"># Define dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s1">&#39;monthly-labor-force-linc/&#39;</span>

<span class="c1"># Define request</span>
<span class="n">request</span> <span class="o">=</span> <span class="s1">&#39;exports/csv&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a request</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">dataset</span> <span class="o">+</span> <span class="n">request</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">response</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Response [200]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load into pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area_name</th>
      <th>area_type</th>
      <th>year</th>
      <th>month</th>
      <th>variable</th>
      <th>value</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gates County</td>
      <td>County</td>
      <td>2013</td>
      <td>4</td>
      <td>Monthly Unemployment (Place of Residence)</td>
      <td>328.0</td>
      <td>2013-04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Transylvania County</td>
      <td>County</td>
      <td>2014</td>
      <td>12</td>
      <td>Monthly Employment (Place of Residence)</td>
      <td>11175.0</td>
      <td>2014-12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jones County</td>
      <td>County</td>
      <td>2015</td>
      <td>7</td>
      <td>Monthly Labor Force (Place of Residence)</td>
      <td>4665.0</td>
      <td>2015-07</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Orange County</td>
      <td>County</td>
      <td>2015</td>
      <td>7</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>5.2</td>
      <td>2015-07</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Franklin County</td>
      <td>County</td>
      <td>2010</td>
      <td>3</td>
      <td>Monthly Unemployment (Place of Residence)</td>
      <td>2980.0</td>
      <td>2010-03</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find unique variables</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Monthly Employment (Place of Residence)&#39;,
       &#39;Monthly Labor Force (Place of Residence)&#39;,
       &#39;Monthly Unemployment (Place of Residence)&#39;,
       &#39;Monthly Unemployment Rate (Place of Residence)(Percent)&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter by specific variable</span>
<span class="n">unemployment</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Monthly Unemployment Rate (Place of Residence)(Percent)&#39;</span><span class="p">]</span>
<span class="n">unemployment</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area_name</th>
      <th>area_type</th>
      <th>year</th>
      <th>month</th>
      <th>variable</th>
      <th>value</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Orange County</td>
      <td>County</td>
      <td>2015</td>
      <td>7</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>5.2</td>
      <td>2015-07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gaston County</td>
      <td>County</td>
      <td>2010</td>
      <td>3</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>13.4</td>
      <td>2010-03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Madison County</td>
      <td>County</td>
      <td>2010</td>
      <td>3</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>10.6</td>
      <td>2010-03</td>
    </tr>
    <tr>
      <th>9</th>
      <td>New Hanover County</td>
      <td>County</td>
      <td>2014</td>
      <td>10</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>5.2</td>
      <td>2014-10</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Onslow County</td>
      <td>County</td>
      <td>2013</td>
      <td>5</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>8.5</td>
      <td>2013-05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find unemployment statistics for Orange County, NC</span>
<span class="n">orange_county</span> <span class="o">=</span> <span class="n">unemployment</span><span class="p">[</span><span class="n">unemployment</span><span class="p">[</span><span class="s1">&#39;area_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Orange County&#39;</span><span class="p">]</span>

<span class="c1"># Plot</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">orange_county</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span>
<span class="n">orange_county</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">dates</span>
<span class="n">orange_county</span> <span class="o">=</span> <span class="n">orange_county</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">orange_county</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x16c254950&gt;]
</pre></div>
</div>
<img alt="../../_images/3bcd6daaefa44b9d00743da476efe41d2a3db8fd4e9d6a2fa2be0e4558d95a81.png" src="../../_images/3bcd6daaefa44b9d00743da476efe41d2a3db8fd4e9d6a2fa2be0e4558d95a81.png" />
</div>
</div>
</section>
<section id="url-parameters">
<h2>URL Parameters<a class="headerlink" href="#url-parameters" title="Link to this heading">#</a></h2>
<p>We can use <strong>URL parameters</strong> to define more specific requests which can be useful for limiting the data we receive from the response. For example, we an query the data to only return data for Durham County using the RESTful call <code class="docutils literal notranslate"><span class="pre">where</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define new request</span>
<span class="n">durham_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s2">&quot;?where=area_name=&#39;Durham County&#39;&quot;</span>
<span class="n">durham_url</span> <span class="o">=</span> <span class="n">durham_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;%20&quot;</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">durham_url</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">durham_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">durham_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area_name</th>
      <th>area_type</th>
      <th>year</th>
      <th>month</th>
      <th>variable</th>
      <th>value</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Durham County</td>
      <td>County</td>
      <td>2018</td>
      <td>6</td>
      <td>Monthly Labor Force (Place of Residence)</td>
      <td>169439.0</td>
      <td>2018-06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Durham County</td>
      <td>County</td>
      <td>2006</td>
      <td>8</td>
      <td>Monthly Employment (Place of Residence)</td>
      <td>130964.0</td>
      <td>2006-08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Durham County</td>
      <td>County</td>
      <td>2020</td>
      <td>2</td>
      <td>Monthly Unemployment (Place of Residence)</td>
      <td>5448.0</td>
      <td>2020-02</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Durham County</td>
      <td>County</td>
      <td>2006</td>
      <td>1</td>
      <td>Monthly Unemployment Rate (Place of Residence)...</td>
      <td>3.8</td>
      <td>2006-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Durham County</td>
      <td>County</td>
      <td>2009</td>
      <td>2</td>
      <td>Monthly Employment (Place of Residence)</td>
      <td>128301.0</td>
      <td>2009-02</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="census-bureau-data">
<h2>Census Bureau data<a class="headerlink" href="#census-bureau-data" title="Link to this heading">#</a></h2>
<p>The Census Bureau also has an API for accessing data.</p>
<a class="reference internal image-reference" href="../../_images/census-api.png"><img alt="../../_images/census-api.png" class="align-center" src="../../_images/census-api.png" style="width: 800px;" /></a>
<p>We start with defining the host name and dataset that we are interested in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The American Community Survey (ACS) is a continuous, nationwide survey conducted by the Census Bureau that collects information <strong>every year</strong>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define base URL for American Community Survey in 2023)</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://api.census.gov/data/2023/acs/acs1&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Next we add <code class="docutils literal notranslate"><span class="pre">get</span></code> to our query, followed by <code class="docutils literal notranslate"><span class="pre">NAME,</span></code> and the variables we are interested in.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>B01003_001E</strong> is just total population variable.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;get=NAME,B01003_001E&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>We then define our places of interest, noting that the wildcard (<code class="docutils literal notranslate"><span class="pre">*</span></code>) indicates <strong>all values</strong>. Here we define all counties in North Carolina which has a <strong>Federal Information Processing Standards (FIPS) code = 37</strong>. We also define our API key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">place</span> <span class="o">=</span> <span class="s1">&#39;for=county:*&amp;in=state:37&#39;</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;key=5f7e25f1ce5f52828e64cc4e5ff5f470759b4e03&#39;</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="n">query</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="n">place</span> <span class="o">+</span> <span class="s1">&#39;&amp;&#39;</span> <span class="o">+</span> <span class="n">key</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>https://api.census.gov/data/2023/acs/acs1?get=NAME,B01003_001E&amp;for=county:*&amp;in=state:37&amp;key=5f7e25f1ce5f52828e64cc4e5ff5f470759b4e03
</pre></div>
</div>
</div>
</div>
<p>We can then send our request and convert the returned data to a DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Send request</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">columns</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;B01003_001E&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;B01003_001E&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>B01003_001E</th>
      <th>state</th>
      <th>county</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alamance County, North Carolina</td>
      <td>179165</td>
      <td>37</td>
      <td>001</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Brunswick County, North Carolina</td>
      <td>159964</td>
      <td>37</td>
      <td>019</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buncombe County, North Carolina</td>
      <td>275901</td>
      <td>37</td>
      <td>021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Burke County, North Carolina</td>
      <td>88338</td>
      <td>37</td>
      <td>023</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cabarrus County, North Carolina</td>
      <td>240016</td>
      <td>37</td>
      <td>025</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="api-wrappers">
<h2>API wrappers<a class="headerlink" href="#api-wrappers" title="Link to this heading">#</a></h2>
<p>It can sometimes be difficult to manually construct HTTP requests. To overcome this, some APIs have <strong>wrappers</strong> which are a software packages that simplify interactions with an API.</p>
<p>We have used an API wrapper already for Census Bureau data called <code class="docutils literal notranslate"><span class="pre">census</span></code>. Conveniently, it returns the data in <strong><code class="docutils literal notranslate"><span class="pre">Pandas</span></code> Dataframes</strong> for further analysis.</p>
<p>The <strong>GitHub repository</strong> is usually the best place to learn about how to use a specific wrapper (or general software package).</p>
<a class="reference internal image-reference" href="../../_images/census-github.png"><img alt="../../_images/census-github.png" class="align-center" src="../../_images/census-github.png" style="width: 1000px;" /></a>
<p>First we should find how to install it, usually either through <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/census-install.png"><img alt="../../_images/census-install.png" class="align-center" src="../../_images/census-install.png" style="width: 800px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import package</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">census</span><span class="w"> </span><span class="kn">import</span> <span class="n">Census</span>
</pre></div>
</div>
</div>
</div>
<p>Then search the documentation for examples…</p>
<a class="reference internal image-reference" href="../../_images/census-examples.png"><img alt="../../_images/census-examples.png" class="align-center" src="../../_images/census-examples.png" style="width: 1000px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">Census</span><span class="p">(</span><span class="s2">&quot;5f7e25f1ce5f52828e64cc4e5ff5f470759b4e03&quot;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">acs5</span><span class="o">.</span><span class="n">state</span><span class="p">((</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;B25034_010E&#39;</span><span class="p">),</span> <span class="s1">&#39;37&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;NAME&#39;: &#39;North Carolina&#39;, &#39;B25034_010E&#39;: 152740.0, &#39;state&#39;: &#39;37&#39;}]
</pre></div>
</div>
</div>
</div>
<a class="reference internal image-reference" href="../../_images/more-examples.png"><img alt="../../_images/more-examples.png" class="align-center" src="../../_images/more-examples.png" style="width: 1000px;" /></a>
</section>
<section id="hydrological-data-from-usgs">
<h2>Hydrological data from USGS<a class="headerlink" href="#hydrological-data-from-usgs" title="Link to this heading">#</a></h2>
<p>Let’s have a look at one last API wrapper called <a class="reference external" href="https://github.com/DOI-USGS/dataretrieval-python"><code class="docutils literal notranslate"><span class="pre">dataretrieval</span></code></a> which was developed by USGS to retrieve hydrologic data from the <strong>USGS National Water Information System (NWIS)</strong>.</p>
<a class="reference internal image-reference" href="../../_images/usgs-github.png"><img alt="../../_images/usgs-github.png" class="align-center" src="../../_images/usgs-github.png" style="width: 1000px;" /></a>
<p>Again, the documentation makes it clear that we should install it using either <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/usgs-install.png"><img alt="../../_images/usgs-install.png" class="align-center" src="../../_images/usgs-install.png" style="width: 800px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">dataretrieval</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can look through the documentation to see if the examples function as expected.</p>
<a class="reference internal image-reference" href="../../_images/usgs.png"><img alt="../../_images/usgs.png" class="align-center" src="../../_images/usgs.png" style="width: 1000px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the functions for downloading data from NWIS</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dataretrieval.nwis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nwis</span>

<span class="c1"># Specify the USGS site code</span>
<span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;03339000&#39;</span>

<span class="c1"># Get instantaneous values (iv)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">nwis</span><span class="o">.</span><span class="n">get_record</span><span class="p">(</span><span class="n">sites</span><span class="o">=</span><span class="n">site</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="s1">&#39;dv&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020-10-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2021-09-30&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>site_no</th>
      <th>00010_ysi_Mean</th>
      <th>00010_ysi_Mean_cd</th>
      <th>00060_Mean</th>
      <th>00060_Mean_cd</th>
      <th>00065_Mean</th>
      <th>00065_Mean_cd</th>
      <th>00095_Mean</th>
      <th>00095_Mean_cd</th>
      <th>00300_Minimum</th>
      <th>...</th>
      <th>63680_hach-solitax_Mean</th>
      <th>63680_hach-solitax_Mean_cd</th>
      <th>63680_ysi_Mean</th>
      <th>63680_ysi_Mean_cd</th>
      <th>99133_Maximum</th>
      <th>99133_Maximum_cd</th>
      <th>99133_Minimum</th>
      <th>99133_Minimum_cd</th>
      <th>99133_Mean</th>
      <th>99133_Mean_cd</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-10-01 00:00:00+00:00</th>
      <td>03339000</td>
      <td>14.9</td>
      <td>A</td>
      <td>75.7</td>
      <td>A</td>
      <td>2.04</td>
      <td>A</td>
      <td>672.0</td>
      <td>A</td>
      <td>8.9</td>
      <td>...</td>
      <td>5.5</td>
      <td>A</td>
      <td>3.7</td>
      <td>A</td>
      <td>4.1</td>
      <td>A</td>
      <td>3.3</td>
      <td>A</td>
      <td>3.7</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-10-02 00:00:00+00:00</th>
      <td>03339000</td>
      <td>14.5</td>
      <td>A</td>
      <td>66.0</td>
      <td>A</td>
      <td>1.99</td>
      <td>A</td>
      <td>678.0</td>
      <td>A</td>
      <td>9.2</td>
      <td>...</td>
      <td>5.4</td>
      <td>A</td>
      <td>3.6</td>
      <td>A</td>
      <td>4.2</td>
      <td>A</td>
      <td>3.8</td>
      <td>A</td>
      <td>4.1</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-10-03 00:00:00+00:00</th>
      <td>03339000</td>
      <td>14.2</td>
      <td>A</td>
      <td>60.2</td>
      <td>A</td>
      <td>1.96</td>
      <td>A</td>
      <td>678.0</td>
      <td>A</td>
      <td>9.4</td>
      <td>...</td>
      <td>4.9</td>
      <td>A</td>
      <td>3.2</td>
      <td>A</td>
      <td>3.8</td>
      <td>A</td>
      <td>3.0</td>
      <td>A</td>
      <td>3.4</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-10-04 00:00:00+00:00</th>
      <td>03339000</td>
      <td>14.4</td>
      <td>A</td>
      <td>68.8</td>
      <td>A</td>
      <td>2.01</td>
      <td>A</td>
      <td>705.0</td>
      <td>A</td>
      <td>9.1</td>
      <td>...</td>
      <td>4.7</td>
      <td>A</td>
      <td>3.3</td>
      <td>A</td>
      <td>3.0</td>
      <td>A</td>
      <td>2.6</td>
      <td>A</td>
      <td>2.8</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2020-10-05 00:00:00+00:00</th>
      <td>03339000</td>
      <td>13.4</td>
      <td>A</td>
      <td>66.8</td>
      <td>A</td>
      <td>1.99</td>
      <td>A</td>
      <td>718.0</td>
      <td>A</td>
      <td>9.6</td>
      <td>...</td>
      <td>4.4</td>
      <td>A</td>
      <td>3.1</td>
      <td>A</td>
      <td>3.4</td>
      <td>A</td>
      <td>2.7</td>
      <td>A</td>
      <td>3.0</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 57 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;00060_Mean&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x179d0bb30&gt;]
</pre></div>
</div>
<img alt="../../_images/c9292d5c2d7fa15887995e4024b43dd5101b21a12dd399611ad3eb10da4407a6.png" src="../../_images/c9292d5c2d7fa15887995e4024b43dd5101b21a12dd399611ad3eb10da4407a6.png" />
</div>
</div>
</section>
<section id="tips-for-apis">
<h2>Tips for APIs<a class="headerlink" href="#tips-for-apis" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Take a minute to familiarize yourself with the syntax for API calls using official website</p></li>
<li><p>Be aware that API wrappers are often easier to use, just make sure that the wrapper is up-to-date (e.g. last commit in GitHub)</p></li>
<li><p>Read the <code class="docutils literal notranslate"><span class="pre">docs</span></code>, <code class="docutils literal notranslate"><span class="pre">demos</span></code>, <code class="docutils literal notranslate"><span class="pre">examples</span></code> to find what we’re looking for (sometimes they are not that comprehensive)</p></li>
<li><p>If you can’t find what you’re looking for, inspect the source code (<code class="docutils literal notranslate"><span class="pre">.py</span></code> files)</p></li>
</ul>
</section>
<section id="climate-and-satellite-data">
<h2>Climate and satellite data<a class="headerlink" href="#climate-and-satellite-data" title="Link to this heading">#</a></h2>
<p>Data from climate models and satellite remote sensing can also be downloaded programmatically. These datasets usually have large file sizes so its not advisable to download climate and satellite data locally. Instead there are several <strong>catalogs</strong> that host the data in the cloud. Examples include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://developers.google.com/earth-engine/datasets">Google’s Earth Engine Data Catalog</a></p></li>
<li><p><a class="reference external" href="https://element84.com/earth-search/">AWS Earth Search</a></p></li>
<li><p><a class="reference external" href="https://planetarycomputer.microsoft.com/">Microsoft’s Planetary Computer</a></p></li>
</ul>
<p>All three of these catalogs are now published as <strong>SpatioTemporal Asset Catalogs (STAC)</strong> which is open metadata standard that provides a <strong>common structure</strong> for describing geospatial information, so it can more easily be worked with, indexed, and discovered.</p>
<p>We can query STAC catalogs using the <code class="docutils literal notranslate"><span class="pre">pystac-client</span></code> Python package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pystac</span><span class="o">-</span><span class="n">client</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pystac_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>
</pre></div>
</div>
</div>
</div>
<p>In this demo, we will search for satellite imagery using Microsoft’s Planetary Computer.</p>
<a class="reference internal image-reference" href="../../_images/mpc.png"><img alt="../../_images/mpc.png" class="align-center" src="../../_images/mpc.png" style="width: 800px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">planetary</span><span class="o">-</span><span class="n">computer</span>
</pre></div>
</div>
</div>
</div>
<p>We can import <code class="docutils literal notranslate"><span class="pre">planetary_computer</span></code> as a package. Since actual data assets are in <strong>private</strong> Azure Blob Storage containers, we use the <code class="docutils literal notranslate"><span class="pre">modifier=planetary_computer.sign_inplace</span></code> to automatically generate a token granting access to the file is included in the URL.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">planetary_computer</span><span class="o">,</span><span class="w"> </span><span class="nn">requests</span>

<span class="n">catalog</span> <span class="o">=</span> <span class="n">Client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
    <span class="s2">&quot;https://planetarycomputer.microsoft.com/api/stac/v1&quot;</span><span class="p">,</span>
    <span class="n">modifier</span><span class="o">=</span><span class="n">planetary_computer</span><span class="o">.</span><span class="n">sign_inplace</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="search-catalog">
<h2>Search catalog<a class="headerlink" href="#search-catalog" title="Link to this heading">#</a></h2>
<p>A list of collections in the catalog can be found at <a class="reference external" href="https://planetarycomputer.microsoft.com/catalog">https://planetarycomputer.microsoft.com/catalog</a>. In this demo, we will be produce a nice image of Store Glacier, Greenland in 2025 using Landsat imagery.</p>
<a class="reference internal image-reference" href="../../_images/landsat-collection.png"><img alt="../../_images/landsat-collection.png" class="align-center" src="../../_images/landsat-collection.png" style="width: 800px;" /></a>
<p>We can search the catalog using spatial information (e.g. a point of bounding box) and/or dates. We find that 76 images match our search criteria.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">items</span></code> objects contain the image metadata as GeoJSON features so it can easily be converted to a DataFrame.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define point of interest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">50.57</span><span class="p">,</span><span class="mf">70.40</span><span class="p">)</span>
<span class="n">time_range</span> <span class="o">=</span> <span class="s2">&quot;2025-05-01/2025-08-31&quot;</span>

<span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;landsat-c2-l2&quot;</span><span class="p">],</span> <span class="n">intersects</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="n">time_range</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">item_collection</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>76
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="o">.</span><span class="n">from_features</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">crs</span><span class="o">=</span><span class="s2">&quot;epsg:4326&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>gsd</th>
      <th>created</th>
      <th>sci:doi</th>
      <th>datetime</th>
      <th>platform</th>
      <th>proj:shape</th>
      <th>description</th>
      <th>instruments</th>
      <th>eo:cloud_cover</th>
      <th>...</th>
      <th>landsat:scene_id</th>
      <th>landsat:wrs_path</th>
      <th>landsat:wrs_type</th>
      <th>view:sun_azimuth</th>
      <th>landsat:correction</th>
      <th>view:sun_elevation</th>
      <th>landsat:cloud_cover_land</th>
      <th>landsat:collection_number</th>
      <th>landsat:collection_category</th>
      <th>proj:code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POLYGON ((-53.25933 72.07025, -55.53393 70.484...</td>
      <td>30</td>
      <td>2025-09-03T09:19:49.891054Z</td>
      <td>10.5066/P9OGBGM6</td>
      <td>2025-08-31T15:18:53.992896Z</td>
      <td>landsat-9</td>
      <td>[8771, 8741]</td>
      <td>Landsat Collection 2 Level-2</td>
      <td>[oli, tirs]</td>
      <td>99.30</td>
      <td>...</td>
      <td>LC90120102025243LGN00</td>
      <td>012</td>
      <td>2</td>
      <td>177.300261</td>
      <td>L2SP</td>
      <td>27.452730</td>
      <td>100.00</td>
      <td>02</td>
      <td>T2</td>
      <td>EPSG:32622</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((-50.54113 70.74943, -52.5527 69.1447...</td>
      <td>30</td>
      <td>2025-09-04T09:20:01.419954Z</td>
      <td>10.5066/P9OGBGM6</td>
      <td>2025-08-26T15:00:43.927501Z</td>
      <td>landsat-9</td>
      <td>[8561, 8521]</td>
      <td>Landsat Collection 2 Level-2</td>
      <td>[oli, tirs]</td>
      <td>62.78</td>
      <td>...</td>
      <td>LC90090112025238LGN00</td>
      <td>009</td>
      <td>2</td>
      <td>174.738517</td>
      <td>L2SP</td>
      <td>30.492094</td>
      <td>67.76</td>
      <td>02</td>
      <td>T1</td>
      <td>EPSG:32622</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((-52.06021 70.7526, -54.07254 69.1477...</td>
      <td>30</td>
      <td>2025-09-05T09:25:17.621826Z</td>
      <td>10.5066/P9OGBGM6</td>
      <td>2025-08-25T15:06:50.457317Z</td>
      <td>landsat-8</td>
      <td>[8641, 8591]</td>
      <td>Landsat Collection 2 Level-2</td>
      <td>[oli, tirs]</td>
      <td>72.40</td>
      <td>...</td>
      <td>LC80100112025237LGN00</td>
      <td>010</td>
      <td>2</td>
      <td>174.666137</td>
      <td>L2SP</td>
      <td>30.837089</td>
      <td>72.12</td>
      <td>02</td>
      <td>T1</td>
      <td>EPSG:32622</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((-50.12952 72.07276, -52.40935 70.487...</td>
      <td>30</td>
      <td>2025-09-05T09:25:15.555221Z</td>
      <td>10.5066/P9OGBGM6</td>
      <td>2025-08-25T15:06:26.562040Z</td>
      <td>landsat-8</td>
      <td>[8631, 8591]</td>
      <td>Landsat Collection 2 Level-2</td>
      <td>[oli, tirs]</td>
      <td>48.42</td>
      <td>...</td>
      <td>LC80100102025237LGN00</td>
      <td>010</td>
      <td>2</td>
      <td>176.775680</td>
      <td>L2SP</td>
      <td>29.575889</td>
      <td>51.28</td>
      <td>02</td>
      <td>T1</td>
      <td>EPSG:32622</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((-51.70736 72.06993, -53.98724 70.484...</td>
      <td>30</td>
      <td>2025-08-27T09:14:59.378558Z</td>
      <td>10.5066/P9OGBGM6</td>
      <td>2025-08-24T15:12:41.610383Z</td>
      <td>landsat-9</td>
      <td>[8691, 8671]</td>
      <td>Landsat Collection 2 Level-2</td>
      <td>[oli, tirs]</td>
      <td>9.86</td>
      <td>...</td>
      <td>LC90110102025236LGN00</td>
      <td>011</td>
      <td>2</td>
      <td>176.666162</td>
      <td>L2SP</td>
      <td>29.918190</td>
      <td>8.65</td>
      <td>02</td>
      <td>T1</td>
      <td>EPSG:32622</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div></div></div>
</div>
</section>
<section id="find-least-cloudy-image">
<h2>Find least cloudy image<a class="headerlink" href="#find-least-cloudy-image" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">eo:cloud_cover</span></code> columns provides the amount of cloud cover as a percentage of the image. We will find the least cloudy image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_item</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selected_item</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Item id=LC08_L2SP_009011_20250530_02_T1&gt;
</pre></div>
</div>
</div>
</div>
<p>Each STAC item has one or more <strong>assets</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">assets</span> <span class="o">=</span> <span class="n">selected_item</span><span class="o">.</span><span class="n">assets</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">asset</span> <span class="ow">in</span> <span class="n">assets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">asset</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>qa: Surface Temperature Quality Assessment Band
ang: Angle Coefficients File
red: Red Band
blue: Blue Band
drad: Downwelled Radiance Band
emis: Emissivity Band
emsd: Emissivity Standard Deviation Band
trad: Thermal Radiance Band
urad: Upwelled Radiance Band
atran: Atmospheric Transmittance Band
cdist: Cloud Distance Band
green: Green Band
nir08: Near Infrared Band 0.8
lwir11: Surface Temperature Band
swir16: Short-wave Infrared Band 1.6
swir22: Short-wave Infrared Band 2.2
coastal: Coastal/Aerosol Band
mtl.txt: Product Metadata File (txt)
mtl.xml: Product Metadata File (xml)
mtl.json: Product Metadata File (json)
qa_pixel: Pixel Quality Assessment Band
qa_radsat: Radiometric Saturation and Terrain Occlusion Quality Assessment Band
qa_aerosol: Aerosol Quality Assessment Band
tilejson: TileJSON with default rendering
rendered_preview: Rendered preview
</pre></div>
</div>
</div>
</div>
</section>
<section id="show-rendered-image">
<h2>Show rendered image<a class="headerlink" href="#show-rendered-image" title="Link to this heading">#</a></h2>
<p>Each asset contains metadata including a <strong>Hypertext Reference</strong> or <code class="docutils literal notranslate"><span class="pre">href</span></code> that provides the destination URL to the actual data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;rendered_preview&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;href&#39;: &#39;https://planetarycomputer.microsoft.com/api/data/v1/item/preview.png?collection=landsat-c2-l2&amp;item=LC08_L2SP_009011_20250530_02_T1&amp;assets=red&amp;assets=green&amp;assets=blue&amp;color_formula=gamma+RGB+2.7%2C+saturation+1.5%2C+sigmoidal+RGB+15+0.55&amp;format=png&#39;,
 &#39;type&#39;: &#39;image/png&#39;,
 &#39;title&#39;: &#39;Rendered preview&#39;,
 &#39;rel&#39;: &#39;preview&#39;,
 &#39;roles&#39;: [&#39;overview&#39;]}
</pre></div>
</div>
</div>
</div>
<p>We can display the <code class="docutils literal notranslate"><span class="pre">rendered_preview</span></code> to check that our search returned the imagery we were expecting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">selected_item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;rendered_preview&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://planetarycomputer.microsoft.com/api/data/v1/item/preview.png?collection=landsat-c2-l2&item=LC08_L2SP_009011_20250530_02_T1&assets=red&assets=green&assets=blue&color_formula=gamma+RGB+2.7%2C+saturation+1.5%2C+sigmoidal+RGB+15+0.55&format=png" width="500"/></div></div>
</div>
</section>
<section id="import-image">
<h2>Import image<a class="headerlink" href="#import-image" title="Link to this heading">#</a></h2>
<p>We can load the image directly into memory using <code class="docutils literal notranslate"><span class="pre">rioxarray</span></code>. The file is quite large but, since it is formatted as a <strong>Cloud-Optimized GeoTIFF (COG)</strong> we can specify an <code class="docutils literal notranslate"><span class="pre">overview_level</span></code> to resample the data before loading.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">rioxarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rio</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">selected_item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">,</span> <span class="n">overview_level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/391c4a73ecad3057591bf4bd17b16c58c238232465d656109595aadb6cf46670.png" src="../../_images/391c4a73ecad3057591bf4bd17b16c58c238232465d656109595aadb6cf46670.png" />
</div>
</div>
</section>
<section id="plot-time-series">
<h2>Plot time-series<a class="headerlink" href="#plot-time-series" title="Link to this heading">#</a></h2>
<p>We can plot a time-series of cloud cover for our image collection. Not a particularly fascinating plot but quite impressive that we were able to do that without downloading an image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.dates</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mdates</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">])</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ts</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s2">&quot;%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cloud cover (%)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Cloud cover (%)&#39;)
</pre></div>
</div>
<img alt="../../_images/c9858f127eb47f06f2dc940e159a36ea427f562e12005c12ea854581dc58b81a.png" src="../../_images/c9858f127eb47f06f2dc940e159a36ea427f562e12005c12ea854581dc58b81a.png" />
</div>
</div>
</section>
<section id="api-limits">
<h2>API limits<a class="headerlink" href="#api-limits" title="Link to this heading">#</a></h2>
<p>So can access any data hosted on the internet using APIs?</p>
<p>Often APIs are not freely available or have limitations. Tech companies (e.g. Zillow, Facebook, X) limit access to their APIs or provide APIs that have limited functionality with the argument that people would use the data for nefarious purposes. This is a problem because, by guarding data, they are also preventing it being used for good causes. Without access to their data it is difficult to tell whether they are in <strong>compliance</strong>.</p>
<p>Either presented with subscription-based API</p>
<a class="reference internal image-reference" href="../../_images/airbnb.png"><img alt="../../_images/airbnb.png" class="align-center" src="../../_images/airbnb.png" style="width: 1000px;" /></a>
<p>Or an API with limited functionality</p>
<a class="reference internal image-reference" href="../../_images/zestimate.png"><img alt="../../_images/zestimate.png" class="align-center" src="../../_images/zestimate.png" style="width: 1000px;" /></a>
</section>
<section id="web-scraping">
<h2>Web scraping<a class="headerlink" href="#web-scraping" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Since web pages are usually organized in a specfic way, we can sometimes still download data from them.</p></li>
<li><p>Web scraping (also known as crawling or harvesting) is the practice of <strong>automatically</strong> gathering data from the internet without the use of an <strong>API</strong></p></li>
<li><p>Most commonly accomplished by writing a program that <strong>queries</strong> a web server, <strong>requests</strong> data (usually in the form of HTML), and <strong>parses</strong> that data to extract information</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/inside_airbnb.png"><img alt="../../_images/inside_airbnb.png" class="align-center" src="../../_images/inside_airbnb.png" style="width: 1000px;" /></a>
</section>
<section id="suppose-a-friend-wanted-to-do-this">
<h2>Suppose a friend wanted to do this?<a class="headerlink" href="#suppose-a-friend-wanted-to-do-this" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code>: parses HTML, the format that web pages are written in</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">selenium</span></code>: launches and controls a web browser. The package is able to fill in forms and simulate mouse clicks in this browser.</p></li>
</ul>
</section>
<section id="selenium">
<h2>Selenium<a class="headerlink" href="#selenium" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Sometimes we want even more control…</p></li>
<li><p>Selenium is a package for performing <strong>web browser automation</strong></p></li>
<li><p>We can use Selenium to enter text in search boxes, click buttons etc.</p></li>
</ul>
<a class="reference internal image-reference" href="../../_images/selenium.png"><img alt="../../_images/selenium.png" class="align-center" src="../../_images/selenium.png" style="width: 200px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># Install webdriver_manager: https://github.com/SergeyPirogov/webdriver_manager</span>
<span class="err">!</span><span class="n">pip3</span> <span class="n">install</span> <span class="n">webdriver_manager</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium</span><span class="w"> </span><span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.chrome.service</span><span class="w"> </span><span class="kn">import</span> <span class="n">Service</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">selenium.webdriver.common.by</span><span class="w"> </span><span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">webdriver_manager.chrome</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChromeDriverManager</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install Chrome webdriver</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">Service</span><span class="p">(</span><span class="n">ChromeDriverManager</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">()))</span>

<span class="c1"># Open a web browser at the following page</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://www.google.com/maps&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<a class="reference internal image-reference" href="../../_images/google_maps.png"><img alt="../../_images/google_maps.png" class="align-center" src="../../_images/google_maps.png" style="width: 1000px;" /></a>
<a class="reference internal image-reference" href="../../_images/inspect.png"><img alt="../../_images/inspect.png" class="align-center" src="../../_images/inspect.png" style="width: 1000px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter some text in the search box</span>
<span class="n">inputElement</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&quot;searchboxinput&quot;</span><span class="p">)</span>
<span class="n">inputElement</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s1">&#39;South Sister Oregon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<a class="reference internal image-reference" href="../../_images/enter_text.png"><img alt="../../_images/enter_text.png" class="align-center" src="../../_images/enter_text.png" style="width: 1000px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Click search button</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&quot;searchbox-searchbutton&quot;</span><span class="p">)</span>
<span class="n">element</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<a class="reference internal image-reference" href="../../_images/search.png"><img alt="../../_images/search.png" class="align-center" src="../../_images/search.png" style="width: 900px;" /></a>
</section>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://earthdatascience.org/courses/use-data-open-source-python/intro-to-apis/apis-in-python/">Earth Data Analytics Online Certificate Chapter 15: APIs</a></p>
<p><a class="reference external" href="https://planetarycomputer.microsoft.com/docs/quickstarts/reading-stac/">Reading Data from the STAC API</a></p>
<p><a class="reference external" href="https://hamedalemo.github.io/advanced-geo-python/lectures/11_earth_search_tutorial.html">Tutorial for Searching a STAC Catalog</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures/unit3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../labs/assignment7.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Assignment 8</p>
      </div>
    </a>
    <a class="right-next"
       href="../../final-project/initialize.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Initialize GitHub repository</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apis">APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-request">API request</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#restful-web-apis">RESTful web APIs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#north-carolina-data">North Carolina data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#url-parameters">URL Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#census-bureau-data">Census Bureau data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-wrappers">API wrappers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hydrological-data-from-usgs">Hydrological data from USGS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-for-apis">Tips for APIs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#climate-and-satellite-data">Climate and satellite data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#search-catalog">Search catalog</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#find-least-cloudy-image">Find least cloudy image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#show-rendered-image">Show rendered image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-image">Import image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-time-series">Plot time-series</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api-limits">API limits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#web-scraping">Web scraping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suppose-a-friend-wanted-to-do-this">Suppose a friend wanted to do this?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#selenium">Selenium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgements">Acknowledgements</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johnny Ryan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>