
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Gridded data analysis &#8212; Geospatial Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/unit1/lecture-4a';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Climate data analysis" href="lecture-4b.html" />
    <link rel="prev" title="Assignment 3" href="../../labs/assignment3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nsoe-logo.png" class="logo__image only-light" alt="Geospatial Data Science - Home"/>
    <img src="../../_static/nsoe-logo.png" class="logo__image only-dark pst-js-only" alt="Geospatial Data Science - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Geospatial Data Science!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../course-info/general-info.html">General information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/schedule.html">Schedule (for Fall 2025)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/github.html">GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/format.html">Formatting answers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../course-info/final-project.html">Final projects</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-1.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/rivers.html">Rivers of the World Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment1.html">Assignment 1</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-2.html">Vector data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/flooding.html">Residential Flooding Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment2.html">Assignment 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lecture-3.html">Network data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/census.html">Census Activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment3.html">Assignment 3</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Gridded data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-4b.html">Climate data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment4.html">Assignment 4</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-5.html">Machine learning fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/wines.html">Wine activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment5.html">Assignment 5</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../final-project/baby.html">Baby</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-6a.html">Machine learning applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-6b.html">Neural networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/penguins.html">Penguin activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment6.html">Assignment 6</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../final-project/fall-break.html">Fall break</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-project/project-ideas.html">Assignment 7</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/lecture-7.html">Specialized neural networks</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../activities/eurosat.html">EuroSAT activity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labs/assignment7.html">Assignment 8</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit3/lecture-8.html">Data access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-project/readme.html">Make a README</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 11</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit3/lecture-9.html">Code management and collaboration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../final-project/initialize.html">Initialize GitHub repository</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 12</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit3/lecture-10.html">Automating raster analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../activities/contribute.html">Contributing to a GitHub repository</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 13</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit4/lecture-11a.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit4/lecture-11b.html">Maps with data</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ryan-lab-duke/gds-applications-site" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ryan-lab-duke/gds-applications-site/issues/new?title=Issue%20on%20page%20%2Flectures/unit1/lecture-4a.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lectures/unit1/lecture-4a.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Gridded data analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#national-land-cover-database">National Land Cover Database</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gridded-data">Gridded data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#libraries">Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-dataset">Open dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-attributes">Dataset attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#georeferencing">Georeferencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-raster-data">Reading raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-land-cover-type">Single land cover type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-of-land-cover-type">Frequency of land cover type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-land-cover-classes">Aggregate land cover classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#land-cover-change">Land cover change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shrubification">Shrubification?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direction-of-land-cover-change">Direction of land cover change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neigborhood-operations">Neigborhood operations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="gridded-data-analysis">
<h1>Gridded data analysis<a class="headerlink" href="#gridded-data-analysis" title="Link to this heading">#</a></h1>
<p>In this demo, we will be investigating the extent of <strong>shrubification</strong> in Alaska using the <strong>National Land Cover Database (NLCD)</strong>. “Shrubification” describes the expansion of shrubs across the <strong>Arctic</strong>. Shrubs are woody plants with diverse growth forms but are often the tallest plants occupying tundra ecosystems and can form dense thickets with closed canopies in suitable habitats.</p>
<p>Studies indicate that warming temperatures, changes in snow cover, altered disturbance regimes (due to permafrost thaw, tundra fires, anthropogenic activities or changes in herbivory intensity) are all contributing to general <strong>increases in shrub abundance</strong> which will have wide-ranging consequences for the ecosystems and climate of the region (e.g. soil, permafrost, caribou).</p>
<a class="reference internal image-reference" href="../../_images/shrubs.jpeg"><img alt="../../_images/shrubs.jpeg" class="align-center" src="../../_images/shrubs.jpeg" style="width: 600px;" /></a>
<section id="national-land-cover-database">
<h2>National Land Cover Database<a class="headerlink" href="#national-land-cover-database" title="Link to this heading">#</a></h2>
<p>The National Land Cover Database (NLCD) provides <strong>gridded land cover</strong> at a 30 m resolution with a <strong>20-class legend (in Alaska)</strong> based on a modified Anderson Level II classification system.</p>
<p>The database is designed to provide cyclical updates of United States land cover every 2-3 years since 2001.</p>
<p>Enables systematic documententation of land cover change for monitoring and trend assessments.</p>
<a class="reference internal image-reference" href="../../_images/nlcd-classes1.jpg"><img alt="../../_images/nlcd-classes1.jpg" class="align-center" src="../../_images/nlcd-classes1.jpg" style="width: 300px;" /></a>
</section>
<section id="gridded-data">
<h2>Gridded data<a class="headerlink" href="#gridded-data" title="Link to this heading">#</a></h2>
<p>Gridded (or raster) data represent a matrix of cells (or pixels) organized into rows and columns (or a grid). Grid cells can represent data that changes <strong>continuously</strong> across a landscape (surface) such as elevation, air temperature, or reflectance data from satellite imaging platforms. Grid cells can also represent <strong>discrete</strong> data such as vegetation type or land cover.</p>
<a class="reference internal image-reference" href="../../_images/raster-matrix.png"><img alt="../../_images/raster-matrix.png" class="align-center" src="../../_images/raster-matrix.png" style="width: 500px;" /></a>
</section>
<section id="libraries">
<h2>Libraries<a class="headerlink" href="#libraries" title="Link to this heading">#</a></h2>
<p>The main library for accessing and analyzing gridded data in Python is called <code class="docutils literal notranslate"><span class="pre">rasterio</span></code> which builds on the popular <strong>Geographic Raster Abstraction Library</strong> or <strong>GDAL</strong>. It supports read/write access for over 160 gridded data formats (e.g. GeoTIFF, NetCDF4) and includes methods for finding dataset information, reprojecting, resampling, format conversion, and mosaicking.</p>
<a class="reference internal image-reference" href="../../_images/gdal.png"><img alt="../../_images/gdal.png" class="align-center" src="../../_images/gdal.png" style="width: 200px;" /></a>
<p>Let’s get started…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">rasterio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-dataset">
<h2>Open dataset<a class="headerlink" href="#open-dataset" title="Link to this heading">#</a></h2>
<p>The data is formatted as a GeoTIFF (<code class="docutils literal notranslate"><span class="pre">.tif</span></code>) file which is one of the many formats that can be read by <code class="docutils literal notranslate"><span class="pre">rasterio</span></code>. We can open the dataset using the function <code class="docutils literal notranslate"><span class="pre">open()</span></code> which accepts a <strong>path string</strong> and returns a <strong>dataset object</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The data for this demo can be accessed <a class="reference external" href="https://www.dropbox.com/sh/czfmie4piindv8n/AAAiZCdIoi9dSqVTIHK0c8yPa?dl=0">here</a>.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">src</span></code> stands for <strong>source</strong></p>
</div>
</aside>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;data/nlcd_2016_ak.tif&#39;</span><span class="p">)</span>
<span class="n">src</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;open DatasetReader name=&#39;data/nlcd_2016_ak.tif&#39; mode=&#39;r&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset-attributes">
<h2>Dataset attributes<a class="headerlink" href="#dataset-attributes" title="Link to this heading">#</a></h2>
<p>The <strong>dataset object</strong> contains a number of <strong>attributes</strong> which can be explored using the following methods. Remember that a raster <strong>band</strong> is an array of values representing <strong>a single</strong> variable in 2D space. All bands of a dataset have the <strong>same</strong> number of rows and columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of bands: </span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Width: </span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Height: </span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data type: </span><span class="si">{</span><span class="n">src</span><span class="o">.</span><span class="n">dtypes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of bands: 1
Width: 3991
Height: 2868
Data type: (&#39;uint8&#39;,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="georeferencing">
<h2>Georeferencing<a class="headerlink" href="#georeferencing" title="Link to this heading">#</a></h2>
<p>Like vector data, pixels in raster data can be mapped to regions on the Earth’s surface. Like <code class="docutils literal notranslate"><span class="pre">GeoPandas</span></code>, we can display the <strong>coordinate reference system</strong> of our data using the <code class="docutils literal notranslate"><span class="pre">crs</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRS.from_wkt(&#39;PROJCS[&quot;WGS_1984_Albers&quot;,GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]],PROJECTION[&quot;Albers_Conic_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,50],PARAMETER[&quot;longitude_of_center&quot;,-154],PARAMETER[&quot;standard_parallel_1&quot;,55],PARAMETER[&quot;standard_parallel_2&quot;,65],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1,AUTHORITY[&quot;EPSG&quot;,&quot;9001&quot;]],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH]]&#39;)
</pre></div>
</div>
</div>
</div>
<p>The output from this function can be a little overwelming but there is some useful information contained here. For example it looks like the data are projected using an <a class="reference external" href="https://en.wikipedia.org/wiki/Albers_projection"><strong>Albers projection system</strong></a> and the units are in <strong>meters</strong>.</p>
<p>We can display some more specific information about a dataset’s projection using the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method. This function returns the <strong>spatial resolution</strong> of the dataset (i.e. the dimensions that each pixel of our dataset represents on the ground) and the coordinates of the <strong>top left</strong> corner.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Affine(30.000052000454264, 0.0, -351410.251360936,
       0.0, -29.996428936149588, 1939259.112990518)
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can display the bounding box of our dataset using the <code class="docutils literal notranslate"><span class="pre">bounds()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">.</span><span class="n">bounds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BoundingBox(left=-351410.251360936, bottom=1853229.354801641, right=-231680.043827123, top=1939259.112990518)
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-raster-data">
<h2>Reading raster data<a class="headerlink" href="#reading-raster-data" title="Link to this heading">#</a></h2>
<p>Now that we have some basic information, we can go ahead and import our data as a NumPy <strong>N-D array</strong> using the <code class="docutils literal notranslate"><span class="pre">read()</span></code> function. Data from each band can be accessed by an index number.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that bands are indexed from 1 due to a  GDAL convention.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_2016</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nlcd_2016</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[42, 42, 42, ..., 52, 52, 41],
       [42, 42, 42, ..., 52, 52, 41],
       [42, 42, 42, ..., 41, 41, 52],
       ...,
       [11, 11, 11, ..., 90, 11, 90],
       [11, 11, 11, ..., 90, 90, 90],
       [11, 11, 31, ..., 52, 52, 90]], shape=(2868, 3991), dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">nlcd_2016</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-data">
<h2>Plot data<a class="headerlink" href="#plot-data" title="Link to this heading">#</a></h2>
<p>We can have a look at the data using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Since the dataset is so big (eight billion pixels!), we will just plot a subset of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nlcd_2016</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Alaska land cover in 2016&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Alaska land cover in 2016&#39;)
</pre></div>
</div>
<img alt="../../_images/8779a677ddb27926eb9034f850db9ab4d681697889136905b185753f66677669.png" src="../../_images/8779a677ddb27926eb9034f850db9ab4d681697889136905b185753f66677669.png" />
</div>
</div>
</section>
<section id="single-land-cover-type">
<h2>Single land cover type<a class="headerlink" href="#single-land-cover-type" title="Link to this heading">#</a></h2>
<p>It would be useful to identify what some of these colors mean. To do this we can use <strong>matrix indexing</strong> to find the value of a pixel at a given location (i.e. <code class="docutils literal notranslate"><span class="pre">array[row,</span> <span class="pre">column]</span></code>). In this case we find the land cover at <strong>y (or row) = 500</strong> and <strong>x (or column) = 3000</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_2016</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.uint8(52)
</pre></div>
</div>
</div>
</div>
<p>The land cover type is <strong>52</strong> meaning <strong>shrub/scrub</strong>.</p>
<a class="reference internal image-reference" href="../../_images/nlcd-shrubs.png"><img alt="../../_images/nlcd-shrubs.png" class="align-center" src="../../_images/nlcd-shrubs.png" style="width: 800px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nlcd_2016</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20b&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Alaska land cover in 2016&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Alaska land cover in 2016&#39;)
</pre></div>
</div>
<img alt="../../_images/3087f751684d2a198427024fdd37f71b9a7a15e5e17364b73ae06e7bb0497717.png" src="../../_images/3087f751684d2a198427024fdd37f71b9a7a15e5e17364b73ae06e7bb0497717.png" />
</div>
</div>
</section>
<section id="frequency-of-land-cover-type">
<h2>Frequency of land cover type<a class="headerlink" href="#frequency-of-land-cover-type" title="Link to this heading">#</a></h2>
<p>Clearly shrubs (class 52) cover a large portion the land cover in this region of Alaska. To <strong>quantify</strong> how much area they cover, it would be useful to count the <strong>occurrence of each land cover class</strong>. We can do that using NumPy’s <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.unique.html"><code class="docutils literal notranslate"><span class="pre">unique()</span></code></a> function, making sure we set <code class="docutils literal notranslate"><span class="pre">return_counts</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">nlcd_2016</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{np.uint8(11): np.int64(2378247),
 np.uint8(12): np.int64(35),
 np.uint8(22): np.int64(2445),
 np.uint8(23): np.int64(87),
 np.uint8(31): np.int64(59650),
 np.uint8(41): np.int64(59832),
 np.uint8(42): np.int64(1456210),
 np.uint8(43): np.int64(146517),
 np.uint8(51): np.int64(2517179),
 np.uint8(52): np.int64(1936912),
 np.uint8(71): np.int64(3609),
 np.uint8(72): np.int64(1007993),
 np.uint8(90): np.int64(1161732),
 np.uint8(95): np.int64(715740)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count number of land pixels</span>
<span class="n">land_pixels</span> <span class="o">=</span> <span class="n">nlcd_2016</span><span class="o">.</span><span class="n">size</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df_2016</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="p">(</span><span class="n">counts</span><span class="o">/</span><span class="n">land_pixels</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span> 
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="s1">&#39;count_2016&#39;</span><span class="p">,</span> <span class="s1">&#39;fraction_2016&#39;</span><span class="p">])</span>
<span class="n">df_2016</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count_2016</th>
      <th>fraction_2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>2378247</td>
      <td>20.777634</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>35</td>
      <td>0.000306</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>2445</td>
      <td>0.021361</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>87</td>
      <td>0.000760</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>59650</td>
      <td>0.521134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>41</td>
      <td>59832</td>
      <td>0.522724</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>1456210</td>
      <td>12.722227</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43</td>
      <td>146517</td>
      <td>1.280051</td>
    </tr>
    <tr>
      <th>8</th>
      <td>51</td>
      <td>2517179</td>
      <td>21.991418</td>
    </tr>
    <tr>
      <th>9</th>
      <td>52</td>
      <td>1936912</td>
      <td>16.921896</td>
    </tr>
    <tr>
      <th>10</th>
      <td>71</td>
      <td>3609</td>
      <td>0.031530</td>
    </tr>
    <tr>
      <th>11</th>
      <td>72</td>
      <td>1007993</td>
      <td>8.806364</td>
    </tr>
    <tr>
      <th>12</th>
      <td>90</td>
      <td>1161732</td>
      <td>10.149510</td>
    </tr>
    <tr>
      <th>13</th>
      <td>95</td>
      <td>715740</td>
      <td>6.253086</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This is very useful. With reference to the NLCD land cover classes, our table shows that the most dominant type of land cover is <strong>dwarf shrub</strong> (51) at <strong>22%</strong> althoug <strong>normal shrubs</strong> (52) are not far behind with <strong>17%</strong>. We also have some <strong>evergreen forest</strong> (42) at <strong>13%</strong> and <strong>woody wetlands</strong> (90) at <strong>10%</strong>.</p>
<a class="reference internal image-reference" href="../../_images/nlcd-classes1.jpg"><img alt="../../_images/nlcd-classes1.jpg" class="align-center" src="../../_images/nlcd-classes1.jpg" style="width: 300px;" /></a>
</section>
<section id="aggregate-land-cover-classes">
<h2>Aggregate land cover classes<a class="headerlink" href="#aggregate-land-cover-classes" title="Link to this heading">#</a></h2>
<p>Since we are interested in all kinds of shrubs, we will combine the the <strong>dwarf shrubs</strong> and <strong>shrub/scrub</strong> classes. The most simple way of doing this is to re-assign all grid cells classified as <strong>shrub/scrub</strong> (52) to <strong>dwarf shrubs</strong> (51) using a <strong>mask</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Re-assign land cover class</span>
<span class="n">nlcd_2016</span><span class="p">[</span><span class="n">nlcd_2016</span> <span class="o">==</span> <span class="mi">52</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check there are no more grid cells classified as normal shrubs</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">nlcd_2016</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df_2016</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="p">(</span><span class="n">counts</span><span class="o">/</span><span class="n">land_pixels</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span> 
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="s1">&#39;count_2016&#39;</span><span class="p">,</span> <span class="s1">&#39;fraction_2016&#39;</span><span class="p">])</span>
<span class="n">df_2016</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count_2016</th>
      <th>fraction_2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>2378247</td>
      <td>20.777634</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>35</td>
      <td>0.000306</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>2445</td>
      <td>0.021361</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>87</td>
      <td>0.000760</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>59650</td>
      <td>0.521134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>41</td>
      <td>59832</td>
      <td>0.522724</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>1456210</td>
      <td>12.722227</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43</td>
      <td>146517</td>
      <td>1.280051</td>
    </tr>
    <tr>
      <th>8</th>
      <td>51</td>
      <td>4454091</td>
      <td>38.913313</td>
    </tr>
    <tr>
      <th>9</th>
      <td>71</td>
      <td>3609</td>
      <td>0.031530</td>
    </tr>
    <tr>
      <th>10</th>
      <td>72</td>
      <td>1007993</td>
      <td>8.806364</td>
    </tr>
    <tr>
      <th>11</th>
      <td>90</td>
      <td>1161732</td>
      <td>10.149510</td>
    </tr>
    <tr>
      <th>12</th>
      <td>95</td>
      <td>715740</td>
      <td>6.253086</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="land-cover-change">
<h2>Land cover change<a class="headerlink" href="#land-cover-change" title="Link to this heading">#</a></h2>
<p>The big question here is have these shrubs always occupied a large portion of this region of Alaska? To answer that we could perform the same analysis on a previous NLCD dataset from 2001.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open</span>
<span class="n">src_2001</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;data/nlcd_2001_ak.tif&#39;</span><span class="p">)</span>

<span class="c1"># Read</span>
<span class="n">nlcd_2001</span> <span class="o">=</span> <span class="n">src_2001</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Re-assign land cover class</span>
<span class="n">nlcd_2001</span><span class="p">[</span><span class="n">nlcd_2001</span> <span class="o">==</span> <span class="mi">52</span><span class="p">]</span> <span class="o">=</span> <span class="mi">51</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count occurrence in each class</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">nlcd_2001</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df_2001</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="p">(</span><span class="n">counts</span><span class="o">/</span><span class="n">land_pixels</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span>
                       <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="s1">&#39;count_2001&#39;</span><span class="p">,</span> <span class="s1">&#39;fraction_2001&#39;</span><span class="p">])</span>
<span class="n">df_2001</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count_2001</th>
      <th>fraction_2001</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>2375777</td>
      <td>20.756054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>24</td>
      <td>0.000210</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>2436</td>
      <td>0.021282</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>91</td>
      <td>0.000795</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>58014</td>
      <td>0.506841</td>
    </tr>
    <tr>
      <th>5</th>
      <td>41</td>
      <td>57582</td>
      <td>0.503067</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>1461918</td>
      <td>12.772095</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43</td>
      <td>144954</td>
      <td>1.266395</td>
    </tr>
    <tr>
      <th>8</th>
      <td>51</td>
      <td>4454788</td>
      <td>38.919403</td>
    </tr>
    <tr>
      <th>9</th>
      <td>72</td>
      <td>1009936</td>
      <td>8.823339</td>
    </tr>
    <tr>
      <th>10</th>
      <td>90</td>
      <td>1162063</td>
      <td>10.152402</td>
    </tr>
    <tr>
      <th>11</th>
      <td>95</td>
      <td>718605</td>
      <td>6.278116</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Combining the DataFrames should allow us to compute the difference between 2001 and 2016</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_2001</span><span class="p">,</span> <span class="n">df_2016</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lc&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count_2001</th>
      <th>fraction_2001</th>
      <th>count_2016</th>
      <th>fraction_2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>2375777</td>
      <td>20.756054</td>
      <td>2378247</td>
      <td>20.777634</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>24</td>
      <td>0.000210</td>
      <td>35</td>
      <td>0.000306</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>2436</td>
      <td>0.021282</td>
      <td>2445</td>
      <td>0.021361</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>91</td>
      <td>0.000795</td>
      <td>87</td>
      <td>0.000760</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>58014</td>
      <td>0.506841</td>
      <td>59650</td>
      <td>0.521134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>41</td>
      <td>57582</td>
      <td>0.503067</td>
      <td>59832</td>
      <td>0.522724</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>1461918</td>
      <td>12.772095</td>
      <td>1456210</td>
      <td>12.722227</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43</td>
      <td>144954</td>
      <td>1.266395</td>
      <td>146517</td>
      <td>1.280051</td>
    </tr>
    <tr>
      <th>8</th>
      <td>51</td>
      <td>4454788</td>
      <td>38.919403</td>
      <td>4454091</td>
      <td>38.913313</td>
    </tr>
    <tr>
      <th>9</th>
      <td>72</td>
      <td>1009936</td>
      <td>8.823339</td>
      <td>1007993</td>
      <td>8.806364</td>
    </tr>
    <tr>
      <th>10</th>
      <td>90</td>
      <td>1162063</td>
      <td>10.152402</td>
      <td>1161732</td>
      <td>10.149510</td>
    </tr>
    <tr>
      <th>11</th>
      <td>95</td>
      <td>718605</td>
      <td>6.278116</td>
      <td>715740</td>
      <td>6.253086</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;count_2016&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;count_2001&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;change_percent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;count_2016&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;count_2001&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;count_2001&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count_2001</th>
      <th>fraction_2001</th>
      <th>count_2016</th>
      <th>fraction_2016</th>
      <th>change</th>
      <th>change_percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>2375777</td>
      <td>20.756054</td>
      <td>2378247</td>
      <td>20.777634</td>
      <td>2470</td>
      <td>0.103966</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>24</td>
      <td>0.000210</td>
      <td>35</td>
      <td>0.000306</td>
      <td>11</td>
      <td>45.833333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>2436</td>
      <td>0.021282</td>
      <td>2445</td>
      <td>0.021361</td>
      <td>9</td>
      <td>0.369458</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>91</td>
      <td>0.000795</td>
      <td>87</td>
      <td>0.000760</td>
      <td>-4</td>
      <td>-4.395604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>58014</td>
      <td>0.506841</td>
      <td>59650</td>
      <td>0.521134</td>
      <td>1636</td>
      <td>2.820009</td>
    </tr>
    <tr>
      <th>5</th>
      <td>41</td>
      <td>57582</td>
      <td>0.503067</td>
      <td>59832</td>
      <td>0.522724</td>
      <td>2250</td>
      <td>3.907471</td>
    </tr>
    <tr>
      <th>6</th>
      <td>42</td>
      <td>1461918</td>
      <td>12.772095</td>
      <td>1456210</td>
      <td>12.722227</td>
      <td>-5708</td>
      <td>-0.390446</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43</td>
      <td>144954</td>
      <td>1.266395</td>
      <td>146517</td>
      <td>1.280051</td>
      <td>1563</td>
      <td>1.078273</td>
    </tr>
    <tr>
      <th>8</th>
      <td>51</td>
      <td>4454788</td>
      <td>38.919403</td>
      <td>4454091</td>
      <td>38.913313</td>
      <td>-697</td>
      <td>-0.015646</td>
    </tr>
    <tr>
      <th>9</th>
      <td>72</td>
      <td>1009936</td>
      <td>8.823339</td>
      <td>1007993</td>
      <td>8.806364</td>
      <td>-1943</td>
      <td>-0.192388</td>
    </tr>
    <tr>
      <th>10</th>
      <td>90</td>
      <td>1162063</td>
      <td>10.152402</td>
      <td>1161732</td>
      <td>10.149510</td>
      <td>-331</td>
      <td>-0.028484</td>
    </tr>
    <tr>
      <th>11</th>
      <td>95</td>
      <td>718605</td>
      <td>6.278116</td>
      <td>715740</td>
      <td>6.253086</td>
      <td>-2865</td>
      <td>-0.398689</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="shrubification">
<h2>Shrubification?<a class="headerlink" href="#shrubification" title="Link to this heading">#</a></h2>
<p>Oh dear - the extent of shrubs did <strong>not</strong> increase between 2001 and 2016. One takeaway from this could be that shrubification is <strong>not happening</strong> in this region of the Arctic. But the percentage change in shrubs was very small (-0.02%), well below what we would expect the uncertainty to be in our land cover product.</p>
<p>Other, perhaps more significant changes, that occurred between 2001 and 2016 include an increase in <strong>deciduous forest</strong> (41) by <strong>3.9%</strong>, a decrease in <strong>evergreen forest</strong> (42) by <strong>0.4%</strong>, and a decrease in <strong>emergent herbaceous wetlands</strong> (95) by <strong>0.4%</strong>.</p>
</section>
<section id="direction-of-land-cover-change">
<h2>Direction of land cover change<a class="headerlink" href="#direction-of-land-cover-change" title="Link to this heading">#</a></h2>
<p>It would be interesting to know <strong>how</strong> grid cells changed between 2001 and 2016. We can do this by <strong>masking</strong> the 2016 land cover data with specific grid cells from the 2001 land cover data. For example, in the code below we identify grid cells in 2016 that were classified as <strong>evergreen forest</strong> (class 42) in 2001. We then compute what land cover they are by <strong>masking the 2016 land cover data</strong> and using the <code class="docutils literal notranslate"><span class="pre">unique()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">nlcd_2016</span><span class="p">[</span><span class="n">nlcd_2001</span> <span class="o">==</span> <span class="mi">42</span><span class="p">]</span>
<span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forestchange_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="p">(</span><span class="n">counts</span><span class="o">/</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span>
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lc&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;fraction&#39;</span><span class="p">])</span>
<span class="n">forestchange_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lc</th>
      <th>count</th>
      <th>fraction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>11</td>
      <td>308</td>
      <td>0.021068</td>
    </tr>
    <tr>
      <th>1</th>
      <td>42</td>
      <td>1455641</td>
      <td>99.570633</td>
    </tr>
    <tr>
      <th>2</th>
      <td>51</td>
      <td>4273</td>
      <td>0.292287</td>
    </tr>
    <tr>
      <th>3</th>
      <td>71</td>
      <td>1672</td>
      <td>0.114370</td>
    </tr>
    <tr>
      <th>4</th>
      <td>95</td>
      <td>24</td>
      <td>0.001642</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It looks like most of the <strong>evergreen forest</strong> (99.6%) did not change between 2001 and 2016. When it did, it was most likely to change to <strong>shrub</strong> (51). Let’s finish this section by plotting a map showing where <strong>evergreen forest</strong> was replaced by <strong>shrub</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forest2shrub</span> <span class="o">=</span> <span class="p">(</span><span class="n">nlcd_2001</span> <span class="o">==</span> <span class="mi">42</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">nlcd_2016</span> <span class="o">==</span> <span class="mi">51</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">forest2shrub</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Forest to shrubs in Alaska between 2001 and 2016&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Forest to shrubs in Alaska between 2001 and 2016&#39;)
</pre></div>
</div>
<img alt="../../_images/2b48d70c367756a3f42cccb727b2ec41e8c70ad64b3c6ad0bdcba50ac7f9e2a5.png" src="../../_images/2b48d70c367756a3f42cccb727b2ec41e8c70ad64b3c6ad0bdcba50ac7f9e2a5.png" />
</div>
</div>
<p>At this scale, it’s difficult to see what’s going on. Let’s zoom in a little…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">forest2shrub</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1750</span><span class="p">,</span><span class="mi">2750</span><span class="p">:</span><span class="mi">3750</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Forest to shrubs in Alaska between 2001 and 2016&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Forest to shrubs in Alaska between 2001 and 2016&#39;)
</pre></div>
</div>
<img alt="../../_images/70179bdc85f394f9d73eba4458a8be1e358e3472559c6e2bbdd2a29a836630a0.png" src="../../_images/70179bdc85f394f9d73eba4458a8be1e358e3472559c6e2bbdd2a29a836630a0.png" />
</div>
</div>
</section>
<section id="neigborhood-operations">
<h2>Neigborhood operations<a class="headerlink" href="#neigborhood-operations" title="Link to this heading">#</a></h2>
<p>So far, we have focused on <strong>local operations</strong>, treating individual grid cells as independent observations that are not influenced by each other. In reality, the land cover of a given grid cell is likely to be similar to adjacent grid cells, than distance grid cells.</p>
<p><strong>Tobler’s First Law of Geography</strong> is a fundamental principle of spatial analysis that says,</p>
<blockquote>
<div><p>Everything is related to everything else, but near things are more related than distant things</p>
</div></blockquote>
<p>We can exploit this concept using neigborhood operations. For example, let’s say our land cover dataset contained missing values or outliers. We could easily identify (and replace) these values by comparing them against the values of surrounding grid cells. A <strong>median filter</strong> is a common approach for outlier filtering.</p>
<a class="reference internal image-reference" href="../../_images/median-filter.png"><img alt="../../_images/median-filter.png" class="align-center" src="../../_images/median-filter.png" style="width: 700px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code> package provides many functions for applying these neighborhood operations. We define window size (also termed <strong>kernel</strong>) using the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter and the function automatically slides (or <strong>convolves</strong>) this window across our entire grid.</p>
<a class="reference internal image-reference" href="../../_images/window.png"><img alt="../../_images/window.png" class="align-center" src="../../_images/window.png" style="width: 500px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We chose a large window size to demonstrate the <code class="docutils literal notranslate"><span class="pre">median_filter</span></code> output - <code class="docutils literal notranslate"><span class="pre">size=15</span></code> would be 15 x 15 pixels or a 450 x 450 m window.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">median_filter</span>

<span class="c1"># Apply 9x9 median filter</span>
<span class="n">nlcd_2001_median</span> <span class="o">=</span> <span class="n">median_filter</span><span class="p">(</span><span class="n">nlcd_2001</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nlcd_2001_median</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab20b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d059de2a538e636b3d2505712fe296086a930fb3f2725a372734828814d335b.png" src="../../_images/6d059de2a538e636b3d2505712fe296086a930fb3f2725a372734828814d335b.png" />
</div>
</div>
<p>The median filter reduces the difference between a grid cell and surrounding grid cells. These type of filters are therefore called <strong>low-pass filters</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We could use any window size or shape. Likewise, there is almost no limit to the different operations we could apply to grid cell values in our window.</p>
</div>
<p>A 3×3 Gaussian kernel with sigma=1 provides a weighted mean of neigboring values and can be defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
G = \frac{1}{16}
\begin{bmatrix}
1 &amp; 2 &amp; 1 \\
2 &amp; 4 &amp; 2 \\
1 &amp; 2 &amp; 1
\end{bmatrix}
\end{split}\]</div>
<p>In contrast, a <strong>high-pass filter</strong> emphasizes differences between a grid cell and its neighbors. The classic one is a Laplacian filter:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H =
\begin{bmatrix}
0 &amp; -1 &amp; 0 \\
-1 &amp;  4 &amp; -1 \\
0 &amp; -1 &amp; 0
\end{bmatrix}
\end{split}\]</div>
<p>And <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> and <code class="docutils literal notranslate"><span class="pre">SciPy</span></code> make the linear algebra straightforward.</p>
<p>Since our land cover classes are not continuous values, it doesn’t make sense to apply a Gaussian and Laplacian filter to our data. But we would implement it using <code class="docutils literal notranslate"><span class="pre">generic_filter</span></code> that applies a specific function to each element.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a 3x3 Gaussian kernel (σ=1)</span>
<span class="n">gaussian_kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Normalize</span>
<span class="n">gaussian_kernel</span> <span class="o">=</span> <span class="n">gaussian_kernel</span> <span class="o">/</span> <span class="n">gaussian_kernel</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Define function for generic_filter</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gaussian_filter_func</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">window</span> <span class="o">*</span> <span class="n">gaussian_kernel</span><span class="p">)</span>

<span class="c1"># Apply filter</span>
<span class="n">smoothed</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generic_filter</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">gaussian_filter_func</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s demonstrate one more time, this time using a custom <strong>diversity index</strong> that simply counts the number of unique land covers in each 15 x 15 window.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.ndimage</span><span class="w"> </span><span class="kn">import</span> <span class="n">generic_filter</span>

<span class="k">def</span><span class="w"> </span><span class="nf">diversity_metric</span><span class="p">(</span><span class="n">window</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">unique</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span>

<span class="n">div_map</span> <span class="o">=</span> <span class="n">generic_filter</span><span class="p">(</span><span class="n">nlcd_2001</span><span class="p">,</span> <span class="n">diversity_metric</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception ignored in: &lt;bound method IPythonKernel._clean_thread_parent_frames of &lt;ipykernel.ipkernel.IPythonKernel object at 0x105fe8680&gt;&gt;
Traceback (most recent call last):
  File &quot;/opt/miniconda3/envs/book/lib/python3.12/site-packages/ipykernel/ipkernel.py&quot;, line 790, in _clean_thread_parent_frames
    active_threads = {thread.ident for thread in threading.enumerate()}
                                                 ^^^^^^^^^^^^^^^^^^^^^
  File &quot;/opt/miniconda3/envs/book/lib/python3.12/threading.py&quot;, line 1543, in enumerate
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    with _active_limbo_lock:
         ^^^^^^^^^^^^^^^^^^
SystemError: &lt;built-in method __enter__ of _thread.RLock object at 0x1039967c0&gt; returned a result with an exception set
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">div_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/aaa58bc0df71095034c025a759cb569891ff01739e0a4e2258b10fc66e6b0e0a.png" src="../../_images/aaa58bc0df71095034c025a759cb569891ff01739e0a4e2258b10fc66e6b0e0a.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures/unit1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../labs/assignment3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Assignment 3</p>
      </div>
    </a>
    <a class="right-next"
       href="lecture-4b.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Climate data analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#national-land-cover-database">National Land Cover Database</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gridded-data">Gridded data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#libraries">Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-dataset">Open dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-attributes">Dataset attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#georeferencing">Georeferencing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-raster-data">Reading raster data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-land-cover-type">Single land cover type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-of-land-cover-type">Frequency of land cover type</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-land-cover-classes">Aggregate land cover classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#land-cover-change">Land cover change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shrubification">Shrubification?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direction-of-land-cover-change">Direction of land cover change</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neigborhood-operations">Neigborhood operations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Johnny Ryan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>